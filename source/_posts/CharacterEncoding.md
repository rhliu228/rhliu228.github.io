---
title: 字符编码归纳
date: 2019-06-16 20:57:35
tags:
- 字符编码
---
这篇文章主要是对ASCII，UTF-8，Unicode，GBK编码等概念进行阐述并加以区别。
<!-- more -->
首先阐述三个跟字符相关的概念：
* 字符表：要显示的字符的集合
* 字符编码：字符表中的字符对应的二进制表示
* 字符集：定义了一种规则，将一串二进制数字解释为一个字符

例如，unicode给世界上的字符赋予一个独一无二的二进制编码，这是字符集方案，但是却没有定义字符是如何传输和存储的，而utf-8则是基于unicode的一种编码方案实现。

#### 1. ASCII

ASCII是美国制定的字符编码，使用一个字节（8bit）存储字符，一共规定了128个字符的编码，最前面的一位统一规定为0。其中0-32号字符用于特殊用途的控制码，33-127号字符表示大小写字母和数字。
ASCII扩展字符集利用了字节前面的最高位，这样字符便扩展到255个，扩展的128-255字符主要用于横线、竖线、交叉等形状。

#### 2. 中文编码
* GB2312
GB2312是对ASCII的中文扩展，在这种情况下，原来 0 – 127 号字符代表的含义不变，这就是半角字符。但是两个大于127的字节连在一起时，就代表GB2312编码的字符。这两个字节的范围是：
第一个字节范围是[0xA1(161),0xF7(247)]，第二个字节的范围是[0xA1(161),0xFE(254)]
共收录了6763个汉字，还包括拉丁字母，希腊字母和日文字符，并对ASCII字符里已有的数、标点、字母赋予两个字节的编码，这就是全角字符。、

* GBK
GB2312仅包含了常用汉字，没有编码生僻字以及繁体字，GBK就对其进行了扩展。只要第一个字节大于127，不管后面的字节是否大于127，就是GBK编码的字符。这两个字节的范围是：
第一个字节的范围是[0x81(127),0xFE(254)]，第二个字节的范围是[0x40(64),0x7E(126)]U[0x80(128),0xFE(254)]
GBK包含了GB2312的所有内容，提供了23940个编码，使用了21886个。

*  GB18030
把两个字节在GBK中还没有用完的码位用来编码一些少数民族的语言

（GB2312,GBK,GB18030）最大的特点是两字节长的汉字字符和一字节长的英文字符并存于同一套编码方案里(这几种编码方案，同时用1个字节和两个字节编码)，因此写的程序为了支持中文处理，必须要注意字串里的每一个字节的值，如果这个值是大于127的，那么就认为一个双字节字符集里的字符出现了。

#### 3.unicode
中文采用GB类进行编码，但是其他国家也同样存在着各种编码方式，这样极其容易造成乱码。而unicode对世界上大部分的文字系统进行了整理、编码。但unicode只定义了符号的二进制代码，并没有规定这个二进制编码如何存储。若是要在计算机里存储unicode编码，有两个问题：
* 第一个问题是如何区分unicode和ASCII，计算机如何知道三个字节代表三个符号还是一个符号。
* 采用定长的字节表示unicode字符，比如三个或者四个，对于只用一个字节就能表示的英文字母来说，会造成很大的存储空间浪费，每个英文字母前面必然有2到3个字节是0。
这造成的结果是 ，出现了unicode的多种存储方式，导致unicode在很长时间内无法推广

#### 4.utf-8
utf的含义是UCS Transfer Format，这是随着互联网的普及而诞生的统一的编码方式。utf-8是在互联网上使用最广的一种unicode的实现方式。其他方式还包括UTF-16、UTF-32，不过在互联网上基本不用。
utf-8的最大特点，就是它是一种变长的编码方式，使用1-4个字节表示一个符号，根据不同的符号变换字节长度。
其编码规则是：
1. 单字节的字符，第一位统一为0，后面七位是这个符号的unicode编码，utf-8码只占用一个字节，和ASCII码完全相同。
2. 对于n（n>1）个字节的字母,第一个字节的前n位设为1，第n+1位设置为0，后面字节的前两位都设为10，这n个字节的其余空位用来填空这个字符的unicode编码，高位用0补足。

|Unicode范围  |编码格式 | 剩余位数  |
| :------|:------| :------: |
| 000000-00007F | 0xxxxxxx | 7 |
| 000080-0007FF | 110xxxxx 10xxxxxx | 11 |
| 000800-00FFFF | 1110xxxx 10xxxxxx 10xxxxxx | 16 |
| 010000-10FFFF | 11110xxx 10xxxxxx 10xxxxxx 10xxxxxx |21|

由此可以总结出字符用UTF-8编码的规律：
* 4个字节的utf-8十六进制编码一定是F开头
* 3个字节的utf-8十六进制编码一定是E开头
* 2个字节的utf-8十六进制编码一定是C或者D开头
* 1个字节的utf-8十六进制编码一定是小于8开头

utf-16以两个字节为单位进行编码。utf-8需判断每个字节的开头标志信息，可能解析出错。而utf-16不会判断开头标志，即使错也是错一个字符，容错能力强。
Javascript内部，字符以utf-16的格式存储，每个字符两个字节。对于那些需要四个字节表示的unicode字符（unicode码点大于0xFFFFF），javascript会认为它们是两个字符。不过可以参考es6中关于字符串的扩展，看看是如何解决这个问题的...

参考
* [字符编码笔记：ASCII，Unicode和UTF-8 —— 阮一峰](http://www.ruanyifeng.com/blog/2007/10/ascii_unicode_and_utf-8.html)